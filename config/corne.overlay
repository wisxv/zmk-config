/dts-v1/;
/plugin/;

#include <dt-bindings/zmk/kscan.h>
#include <dt-bindings/led/led.h>

/ {
    fragment@0 {
        target = <&pro_micro_spi>;
        __overlay__ {
            status = "disabled";
        };
    };

    fragment@1 {
        target-path = "/";
        __overlay__ {
            // Настройка RGB подсветки
            rgb_underglow: ws2812 {
                compatible = "worldsemi,ws2812-spi";
                label = "WS2812";
                spi-max-frequency = <8000000>;
                chain-length = <18>;    // 18 светодиодов на половину
                data-pin = <10>;       // D10 (PA14) для nice!nano v2
                spi-bus = <&spi1>;     // Используемый SPI-контроллер
            };

            // Настройка USB CDC ACM для логов
            chosen {
                zephyr,console = &cdc_acm_uart0;
                zephyr,shell-uart = &cdc_acm_uart0;
            };
        };
    };

    fragment@2 {
        target = <&zephyr_udc0>;
        __overlay__ {
            cdc_acm_uart0: cdc_acm_uart0 {
                compatible = "zephyr,cdc-acm-uart";
                label = "CDC_ACM_0";
            };
        };
    };

    // Отключаем неиспользуемые интерфейсы
    fragment@3 {
        target = <&pro_micro_i2c>;
        __overlay__ {
            status = "disabled";
        };
    };

    fragment@4 {
        target = <&pro_micro_serial>;
        __overlay__ {
            status = "disabled";
        };
    };
};
